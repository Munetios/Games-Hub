<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Simon Says - Munetios Games Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://api.munetios.com/beautiful-css/beautiful.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Google+Sans+Flex:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"
    />
    <style>
      body {
        font-family: "Google Sans Flex", system-ui, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
      }
      .simon-board {
        display: grid;
        grid-template-columns: repeat(2, 150px);
        grid-template-rows: repeat(2, 150px);
        gap: 10px;
        margin: 2rem auto;
      }
      .simon-button {
        width: 150px;
        height: 150px;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.1s;
        border: 3px solid rgba(0, 0, 0, 0.3);
      }
      .simon-button:active {
        transform: scale(0.95);
      }
      .simon-button.active {
        filter: brightness(1.8);
        transform: scale(1.05);
      }
      .red {
        background: #dc2626;
      }
      .blue {
        background: #2563eb;
      }
      .green {
        background: #16a34a;
      }
      .yellow {
        background: #ca8a04;
      }
      .toast {
        position: fixed;
        top: 20px;
        right: 20px;
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 1rem 1.5rem;
        border-radius: 12px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        z-index: 1000;
        animation: slideIn 0.3s ease-out;
      }
      @keyframes slideIn {
        from {
          transform: translateX(400px);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }
      .toast.hiding {
        animation: slideOut 0.3s ease-in forwards;
      }
      @keyframes slideOut {
        from {
          transform: translateX(0);
          opacity: 1;
        }
        to {
          transform: translateX(400px);
          opacity: 0;
        }
      }
    </style>
  </head>
  <body class="flex items-center justify-center p-4">
    <div class="liquid-glass p-8 max-w-lg">
      <h1 class="text-4xl font-bold text-white mb-4 text-center">
        üé® Simon Says
      </h1>
      <div class="text-center text-white text-lg mb-4">
        <p>Level: <span id="level" class="font-bold">0</span></p>
        <p>High Score: <span id="highScore" class="font-bold">0</span></p>
      </div>
      <div class="simon-board">
        <div class="simon-button red" data-color="0"></div>
        <div class="simon-button blue" data-color="1"></div>
        <div class="simon-button green" data-color="2"></div>
        <div class="simon-button yellow" data-color="3"></div>
      </div>
      <div class="text-center">
        <button
          id="startBtn"
          class="bg-white/20 hover:bg-white/30 text-white font-bold py-3 px-8 rounded-lg transition"
        >
          <span class="material-symbols-outlined align-middle">play_arrow</span>
          Start Game
        </button>
      </div>
      <div class="mt-4 text-center">
        <a href="index.html" class="text-white/80 hover:text-white underline"
          >‚Üê Back to Hub</a
        >
      </div>
    </div>

    <script>
      let sequence = [];
      let playerSequence = [];
      let level = 0;
      let isPlaying = false;
      let highScore = localStorage.getItem("simonHighScore") || 0;

      document.getElementById("highScore").textContent = highScore;

      const buttons = document.querySelectorAll(".simon-button");
      const sounds = [523, 659, 784, 880]; // C, E, G, A

      function showToast(message, duration = 3000) {
        const toast = document.createElement("div");
        toast.className = "toast";
        toast.textContent = message;
        document.body.appendChild(toast);

        setTimeout(() => {
          toast.classList.add("hiding");
          setTimeout(() => toast.remove(), 300);
        }, duration);
      }

      function playSound(freq) {
        const audioCtx = new (window.AudioContext ||
          window.webkitAudioContext)();
        const oscillator = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();

        oscillator.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        oscillator.frequency.value = freq;
        oscillator.type = "sine";
        gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(
          0.01,
          audioCtx.currentTime + 0.3
        );

        oscillator.start(audioCtx.currentTime);
        oscillator.stop(audioCtx.currentTime + 0.3);
      }

      function flashButton(index) {
        return new Promise((resolve) => {
          buttons[index].classList.add("active");
          playSound(sounds[index]);
          setTimeout(() => {
            buttons[index].classList.remove("active");
            setTimeout(resolve, 200);
          }, 400);
        });
      }

      async function playSequence() {
        isPlaying = true;
        for (const color of sequence) {
          await flashButton(color);
        }
        isPlaying = false;
      }

      function nextRound() {
        level++;
        playerSequence = [];
        sequence.push(Math.floor(Math.random() * 4));
        document.getElementById("level").textContent = level;
        showToast(`üéØ Level ${level}`, 1500);
        setTimeout(playSequence, 1000);
      }

      function gameOver() {
        showToast(`‚ùå Game Over! Level: ${level}`, 3000);

        if (level > highScore) {
          highScore = level;
          localStorage.setItem("simonHighScore", highScore);
          document.getElementById("highScore").textContent = highScore;
          showToast(`üèÜ New High Score: ${level}!`, 3000);
        }

        sequence = [];
        level = 0;
        document.getElementById("level").textContent = level;
      }

      function checkSequence() {
        const currentIndex = playerSequence.length - 1;

        if (playerSequence[currentIndex] !== sequence[currentIndex]) {
          gameOver();
          return;
        }

        if (playerSequence.length === sequence.length) {
          setTimeout(nextRound, 1000);
        }
      }

      buttons.forEach((button, index) => {
        button.addEventListener("click", () => {
          if (isPlaying || level === 0) return;

          playerSequence.push(index);
          flashButton(index);
          checkSequence();
        });
      });

      document.getElementById("startBtn").addEventListener("click", () => {
        showToast("üéÆ Game Started!", 2000);
        nextRound();
      });
    </script>
  </body>
</html>
