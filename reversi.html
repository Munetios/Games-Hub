<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reversi - Munetios Games Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://api.munetios.com/beautiful-css/beautiful.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Google+Sans+Flex:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"
    />
    <style>
      body {
        font-family: "Google Sans Flex", sans-serif;
        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        min-height: 100vh;
        padding: 20px;
      }
      #board {
        display: grid;
        grid-template-columns: repeat(8, 60px);
        grid-template-rows: repeat(8, 60px);
        gap: 2px;
        background: #2d3748;
        padding: 10px;
        border-radius: 8px;
      }
      .cell {
        width: 60px;
        height: 60px;
        background: #059669;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        border-radius: 4px;
      }
      .cell:hover:not(.occupied) {
        background: #10b981;
      }
      .piece {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        border: 3px solid #1f2937;
      }
      .black {
        background: #1f2937;
      }
      .white {
        background: #f3f4f6;
      }
    </style>
  </head>
  <body>
    <div class="max-w-3xl mx-auto">
      <div class="liquid-glass p-8 text-center mb-6">
        <h1 class="text-4xl font-bold text-white mb-4">
          ⚫⚪ Reversi (Othello)
        </h1>
        <div class="flex justify-around text-white text-lg">
          <div>Black: <span id="blackScore" class="font-bold">2</span></div>
          <div>White: <span id="whiteScore" class="font-bold">2</span></div>
          <div>Turn: <span id="turn" class="font-bold">Black</span></div>
        </div>
      </div>

      <div class="liquid-glass p-8 text-center">
        <div id="board" class="mx-auto"></div>
        <div class="mt-6">
          <button
            onclick="newGame()"
            class="bg-white/20 hover:bg-white/30 text-white font-bold py-3 px-8 rounded-lg transition mr-2"
          >
            <span class="material-symbols-outlined align-middle">refresh</span>
            New Game
          </button>
          <a
            href="index.html"
            class="bg-white/20 hover:bg-white/30 text-white font-bold py-3 px-8 rounded-lg transition inline-block"
          >
            ← Back
          </a>
        </div>
      </div>
    </div>

    <script>
      let board = [];
      let currentPlayer = "black";

      function init() {
        newGame();
      }

      function newGame() {
        board = Array(8)
          .fill()
          .map(() => Array(8).fill(null));
        board[3][3] = "white";
        board[3][4] = "black";
        board[4][3] = "black";
        board[4][4] = "white";
        currentPlayer = "black";
        render();
      }

      function render() {
        const boardEl = document.getElementById("board");
        boardEl.innerHTML = "";

        for (let row = 0; row < 8; row++) {
          for (let col = 0; col < 8; col++) {
            const cell = document.createElement("div");
            cell.className = "cell";
            if (board[row][col]) {
              const piece = document.createElement("div");
              piece.className = `piece ${board[row][col]}`;
              cell.appendChild(piece);
              cell.classList.add("occupied");
            } else {
              cell.onclick = () => makeMove(row, col);
            }
            boardEl.appendChild(cell);
          }
        }

        updateScores();
      }

      function makeMove(row, col) {
        const flips = getFlips(row, col, currentPlayer);
        if (flips.length === 0) {
          alert("Invalid move!");
          return;
        }

        board[row][col] = currentPlayer;
        flips.forEach(([r, c]) => (board[r][c] = currentPlayer));

        currentPlayer = currentPlayer === "black" ? "white" : "black";
        document.getElementById("turn").textContent =
          currentPlayer === "black" ? "Black" : "White";
        render();
        checkGameOver();
      }

      function getFlips(row, col, player) {
        if (board[row][col]) return [];

        const directions = [
          [-1, -1],
          [-1, 0],
          [-1, 1],
          [0, -1],
          [0, 1],
          [1, -1],
          [1, 0],
          [1, 1],
        ];
        const flips = [];
        const opponent = player === "black" ? "white" : "black";

        for (let [dr, dc] of directions) {
          const tempFlips = [];
          let r = row + dr;
          let c = col + dc;

          while (
            r >= 0 &&
            r < 8 &&
            c >= 0 &&
            c < 8 &&
            board[r][c] === opponent
          ) {
            tempFlips.push([r, c]);
            r += dr;
            c += dc;
          }

          if (
            r >= 0 &&
            r < 8 &&
            c >= 0 &&
            c < 8 &&
            board[r][c] === player &&
            tempFlips.length > 0
          ) {
            flips.push(...tempFlips);
          }
        }

        return flips;
      }

      function updateScores() {
        let black = 0,
          white = 0;
        board.forEach((row) =>
          row.forEach((cell) => {
            if (cell === "black") black++;
            if (cell === "white") white++;
          })
        );
        document.getElementById("blackScore").textContent = black;
        document.getElementById("whiteScore").textContent = white;
      }

      function checkGameOver() {
        const hasValidMoves = (player) => {
          for (let r = 0; r < 8; r++) {
            for (let c = 0; c < 8; c++) {
              if (getFlips(r, c, player).length > 0) return true;
            }
          }
          return false;
        };

        if (!hasValidMoves(currentPlayer)) {
          currentPlayer = currentPlayer === "black" ? "white" : "black";
          if (!hasValidMoves(currentPlayer)) {
            const black = parseInt(
              document.getElementById("blackScore").textContent
            );
            const white = parseInt(
              document.getElementById("whiteScore").textContent
            );
            setTimeout(() => {
              alert(
                `Game Over!\nBlack: ${black}\nWhite: ${white}\n${
                  black > white ? "Black" : white > black ? "White" : "Tie"
                } Wins!`
              );
            }, 300);
          }
        }
      }

      init();
    </script>
  </body>
</html>
